import{c as h}from"./chunk-AL4X3Q3A.js";import{Ga as n,Qa as m,Rc as t,j as c,la as u,p as i,pa as a}from"./chunk-6XV5UQWZ.js";var d=class o{constructor(e,r){this.router=e;this.platformId=r;this.loadUserFromStorage()}currentUserSubject=new c(null);currentUser$=this.currentUserSubject.asObservable();isAuthenticated=n(!1);currentUser=n(null);loadUserFromStorage(){if(!t(this.platformId))return;let e=localStorage.getItem("omni_scholar_user");if(e)try{let r=JSON.parse(e);this.setUser(r)}catch(r){console.error("Failed to parse stored user:",r),this.clearUser()}}login(e,r){let s={id:"1",email:e,name:"Demo Researcher",role:"researcher",avatar:"https://via.placeholder.com/150"};return this.setUser(s),i(s)}register(e,r,s){let l={id:Date.now().toString(),email:e,name:s,role:"researcher"};return this.setUser(l),i(l)}logout(){this.clearUser(),this.router.navigate(["/"])}setUser(e){this.currentUserSubject.next(e),this.currentUser.set(e),this.isAuthenticated.set(!0),t(this.platformId)&&localStorage.setItem("omni_scholar_user",JSON.stringify(e))}clearUser(){this.currentUserSubject.next(null),this.currentUser.set(null),this.isAuthenticated.set(!1),t(this.platformId)&&localStorage.removeItem("omni_scholar_user")}getCurrentUser(){return this.currentUserSubject.value}isLoggedIn(){return this.isAuthenticated()}getToken(){return t(this.platformId)?localStorage.getItem("omni_scholar_token"):null}setToken(e){t(this.platformId)&&localStorage.setItem("omni_scholar_token",e)}clearToken(){t(this.platformId)&&localStorage.removeItem("omni_scholar_token")}static \u0275fac=function(r){return new(r||o)(a(h),a(m))};static \u0275prov=u({token:o,factory:o.\u0275fac,providedIn:"root"})};export{d as a};
