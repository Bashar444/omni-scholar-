import{a as B}from"./chunk-NDPWHEJZ.js";import{c as O,d as E}from"./chunk-IY43AWBL.js";import{a as I,b as L,c as R,d as V,f as T,g as $,h as F}from"./chunk-63FJNZSZ.js";import{Ac as P,Ad as z,Cc as S,Fb as f,Hb as _,Jb as d,Ra as c,Xb as r,Yb as h,_b as C,ab as M,dc as y,fb as b,pa as x,pb as k,ua as u,va as g,vb as l,vd as U,wb as i,xb as n,xd as j,yd as D,zc as w,zd as A}from"./chunk-PEEDB4LE.js";var W=()=>["/scholar-graph"];function Y(o,e){if(o&1){let t=f();i(0,"button",9),_("click",function(){u(t);let p=d();return g(p.exportCsv())}),i(1,"mat-icon"),r(2,"download"),n(),r(3," Export CSV "),n()}}function H(o,e){if(o&1){let t=f();i(0,"button",10),_("click",function(){u(t);let p=d();return g(p.clearAll())}),i(1,"mat-icon"),r(2,"delete_sweep"),n(),r(3," Clear All "),n()}}function X(o,e){o&1&&(i(0,"div",11)(1,"mat-card")(2,"mat-card-content")(3,"mat-icon",12),r(4,"bookmark_border"),n(),i(5,"p"),r(6,"Your library is empty"),n(),i(7,"p",13),r(8,"Save papers from search results to build your collection"),n(),i(9,"button",4),r(10," Start Searching "),n()()()()),o&2&&(c(9),l("routerLink",y(1,W)))}function q(o,e){if(o&1){let t=f();i(0,"mat-card",16)(1,"mat-card-title",17)(2,"span",18),r(3),n(),i(4,"button",19),_("click",function(){let p=u(t).$implicit,s=d(2);return g(s.remove(p))}),i(5,"mat-icon"),r(6,"delete"),n()()(),i(7,"mat-card-subtitle")(8,"span",20),r(9),n(),i(10,"span",21),r(11),n()(),i(12,"mat-card-content")(13,"div",22)(14,"button",23),_("click",function(){let p=u(t).$implicit,s=d(2);return g(s.viewDetails(p))}),i(15,"mat-icon"),r(16,"info"),n(),r(17," View Details "),n(),i(18,"button",10),_("click",function(){let p=u(t).$implicit,s=d(2);return g(s.openExternal(p))}),i(19,"mat-icon"),r(20,"open_in_new"),n(),r(21," Open "),n()()()()}if(o&2){let t=e.$implicit;c(3),h(t.title),c(),k("aria-label","Remove "+t.title),c(5),C("",t.authors.join(", ")||"Unknown authors"," \u2022 ",t.year),c(2),h(t.source)}}function G(o,e){if(o&1&&(i(0,"div",14),b(1,q,22,5,"mat-card",15),n()),o&2){let t=d();c(),l("ngForOf",t.papers)}}var N=class o{papers=[];lib=x(B);router=x(O);ngOnInit(){this.loadPapers()}loadPapers(){this.papers=this.lib.list()}remove(e){this.lib.toggle(e),this.loadPapers()}clearAll(){confirm(`Clear all ${this.papers.length} saved papers?`)&&(this.papers.forEach(e=>this.lib.toggle(e)),this.loadPapers())}viewDetails(e){this.router.navigate(["/scholar-graph",e.source,e.id],{state:{paper:e}})}openExternal(e){let t=this.linkFor(e);window.open(t,"_blank","noopener")}exportCsv(){let e=["Title","Authors","Year","Source","ID"],t=this.papers.map(m=>[this.escapeCsv(m.title),this.escapeCsv(m.authors.join("; ")),m.year.toString(),m.source,this.escapeCsv(m.id)]),a=[e,...t].map(m=>m.join(",")).join(`
`),p=new Blob([a],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(p),v=document.createElement("a");v.href=s,v.download=`library-${new Date().toISOString().split("T")[0]}.csv`,v.click(),URL.revokeObjectURL(s)}escapeCsv(e){if(!e)return"";let t=e.toString();return t.includes(",")||t.includes('"')||t.includes(`
`)?`"${t.replace(/"/g,'""')}"`:t}linkFor(e){switch(e.source){case"CrossRef":{let t=e.id||"";return t.startsWith("http")?t:`https://doi.org/${encodeURIComponent(t)}`}case"arXiv":{let t=e.id||"";if(t.startsWith("http"))try{let a=new URL(t);return`https://arxiv.org${a.pathname.includes("/abs/")?a.pathname:a.pathname.replace("/pdf/","/abs/")}`}catch{}return`https://arxiv.org/abs/${encodeURIComponent(t)}`}case"PubMed":return`https://pubmed.ncbi.nlm.nih.gov/${encodeURIComponent(e.id)}/`;default:return"#"}}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=M({type:o,selectors:[["app-library"]],decls:19,vars:8,consts:[[1,"library-container"],[1,"header-card"],["mat-card-avatar",""],[1,"header-actions"],["mat-raised-button","","color","primary",3,"routerLink"],["mat-raised-button","",3,"click",4,"ngIf"],["mat-stroked-button","",3,"click",4,"ngIf"],["class","empty",4,"ngIf"],["class","papers-grid",4,"ngIf"],["mat-raised-button","",3,"click"],["mat-stroked-button","",3,"click"],[1,"empty"],[1,"empty-icon"],[1,"hint"],[1,"papers-grid"],["class","paper-card",4,"ngFor","ngForOf"],[1,"paper-card"],[1,"title-row"],[1,"title"],["mat-icon-button","","color","warn",3,"click"],[1,"meta"],[1,"source-badge"],[1,"actions"],["mat-stroked-button","","color","primary",3,"click"]],template:function(t,a){t&1&&(i(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-icon",2),r(4,"bookmark"),n(),i(5,"mat-card-title"),r(6,"My Library"),n(),i(7,"mat-card-subtitle"),r(8),n()(),i(9,"mat-card-content")(10,"div",3)(11,"button",4)(12,"mat-icon"),r(13,"search"),n(),r(14," Search Papers "),n(),b(15,Y,4,0,"button",5)(16,H,4,0,"button",6),n()()(),b(17,X,11,2,"div",7)(18,G,2,1,"div",8),n()),t&2&&(c(8),C("",a.papers.length," saved ",a.papers.length===1?"paper":"papers"),c(3),l("routerLink",y(7,W)),c(4),l("ngIf",a.papers.length),c(),l("ngIf",a.papers.length),c(),l("ngIf",!a.papers.length),c(),l("ngIf",a.papers.length))},dependencies:[S,w,P,F,I,$,R,T,V,L,z,A,D,j,U,E],styles:[".library-container[_ngcontent-%COMP%]{padding:var(--spacing-lg);max-width:1200px;margin:0 auto}.header-card[_ngcontent-%COMP%]{margin-bottom:var(--spacing-lg)}.header-actions[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-md);flex-wrap:wrap;margin-top:var(--spacing-md)}.empty[_ngcontent-%COMP%]{text-align:center}.empty[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:var(--spacing-xl)}.empty-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:var(--mdc-theme-text-secondary-on-background, rgba(0, 0, 0, .6));margin-bottom:var(--spacing-md)}.empty[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{color:var(--mdc-theme-text-secondary-on-background, rgba(0, 0, 0, .6));margin-bottom:var(--spacing-lg)}.papers-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:var(--spacing-md)}.paper-card[_ngcontent-%COMP%]   .title-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:var(--spacing-sm)}.paper-card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex:1;font-size:1rem;line-height:1.4}.paper-card[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:var(--spacing-sm)}.paper-card[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{font-size:.875rem}.paper-card[_ngcontent-%COMP%]   .source-badge[_ngcontent-%COMP%]{background:var(--mdc-theme-primary, #3f51b5);color:#fff;padding:2px 8px;border-radius:12px;font-size:.75rem}.paper-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-sm);margin-top:var(--spacing-md)}"]})};export{N as LibraryComponent};
